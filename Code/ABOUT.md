# About `Code/`

This directory hosts the Stata do-files and Python utilities that power the
DataMéxico municipal trade workflow. The key pieces are:

- **Batch creation:** `00_municipal_batch.do` builds per-state batch files under
  `Code/batch/` and the `myscript.sh` launcher. It calls
  `donefiles_catalog.py` to skip already-downloaded CSVs.
- **Downloader:** `municipal_trade_download_2.py` talks to the DataMéxico
  Tesseract API, fetching municipal or state aggregates with configurable
  drilldowns and flows. It can also convert a saved JSON response to CSV.
- **Catalog builder:** `donefiles_catalog.py` scans `Data/CSV/` once and writes a
  Stata `.dta` with filenames so the Stata scripts can bypass completed jobs.
- **Aggregation:** `aggregate_csvs.py` concatenates the cataloged CSVs into a
  single Stata dataset using multiprocessing and Parquet shards.
- **Post-processing helper:** `01_append_donefiles.do` demonstrates splitting the
  donefile into municipal/state subsets, running aggregation, and applying value
  labels generated by the `labels_*.do` files.

Supporting files:

- `labels_*.do` – Value label definitions generated from aggregated datasets.
- `Month_ID_labels.do` and similar – Legacy label helpers.
- `batch/` – Auto-generated Stata batch files; safe to delete and regenerate.
